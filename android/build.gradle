buildscript {
    repositories {
        google()
        jcenter()
    }

    dependencies {
        classpath 'com.android.tools.build:gradle:3.1.4'
    }
}

apply plugin: 'com.android.library'

android {
    compileSdkVersion 28
    buildToolsVersion "28.0.3"

    defaultConfig {
        minSdkVersion 16
        targetSdkVersion 22
        versionCode 1
        versionName '1.0'
    }
}

repositories {
    google()
    jcenter()

    def found = false
    def parentDir = rootProject.projectDir
    def reactNativeAndroidName = 'React Native (Node Modules)'

    1.upto(4, {
        if (found) return true
        parentDir = parentDir.parentFile
        def reactNativeAndroid = new File(
                parentDir,
                'node_modules/react-native/android'
        )

        if (reactNativeAndroid.exists()) {
            maven {
                url reactNativeAndroid.toString()
                name reactNativeAndroidName
            }

            println "${project.name}: using React Native sources from ${reactNativeAndroid.toString()}"
            found = true
        }
    })

    if (!found) {
        throw new GradleException(
                "${project.name}: unable to locate React Native Android sources, " +
                        "ensure you have you installed React Native as a dependency and try again."
        )
    }
}

dependencies {
    //noinspection GradleDynamicVersion
    api 'com.facebook.react:react-native:+'
    api 'com.revenuecat.purchases:purchases:2.0.0'
}
